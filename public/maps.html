<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SXSW 180</title>

    <style>
        /*MUST DECLARE, OTHERWISE BODY DOESN'T FILL*/
        /*this bypasses the need for 'adjustWindow.js'*/
        html, body {
            width: 100%;
            height: 100%;
            margin: 0px;
            padding: 0px;
            box-sizing: border-box;
        }

        #testDiv {
            display: flex;
            justify-content: center;
            align-items: center;


            background: rgba(240,240,240, 1.0);
            height: 100%;
        }

        #map {
            height: 100%;
            width: 100%;
        }

        .innerDiv {

            margin: 2px;
            background: rgba(255,0,0,1.0);
            height: 200px;
            width: 200px;
            border: 5px solid black;
            border-radius: 10px;
            box-shadow: 1px 2px 2px rgba(50,50,50,0.5);
            transition: background 0.25s, border-radius 0.25s ease, box-shadow 0.25s ease;
        }

        .innerDiv:hover {
            background: rgba(0,255,0,1.0);
            border-radius: 50%;
            box-shadow: 1px 10px 10px rgba(50,50,50, 0.25);
        }

        #nav {

            display: flex;

            flex-direction: row;
            justify-content: flex-end;
            align-items: center;

            position: fixed;
            width: 100%;
            height: 75px;
            background: rgba(240,240,240, 1.0);
            box-shadow: 0px 2px 2px rgba(50,50,50,0.25);
            z-index: 20;
        }

        nav fieldset {
            border: 0px dotted rgba(50,50,50,1.0);
        }

        nav input {
            padding: 10px;
        }

        nav button {
            padding: 10px;
        }

        nav #latLong {

        }

        /*TODO: clean me up*/

        .logo_Img {
            background: url('./img/180Logo_outline.svg');
            background-repeat: no-repeat;
            background-size: 60px 60px;
        }

        #logo {
            position: fixed;
            top: 7px;
            left: 50px;

            width: 60px;
            height: 60px;
        }



    </style>
</head>
<body>

<!--WHERE TO DRAW MAP-->

<nav id="nav">

    <div class="logo_Img" id="logo"> </div>
    <div id="latLong">
        <fieldset>
            <label></label>
            <input id="lat_field" type="number" required placeholder="latitude" value="34.015" steps="0.001">
            <input id="lng_field" type="number" required placeholder="longitude" value="-118.491824" steps="0.001">
            <button id="add_pin_button" type="submit"> add pin </button>
            <button id="remove_bar_button">X</button>
        </fieldset>
    </div>
</nav>

<!--ENABLE + DISABLE DRAW TOOLS-->
<nav id="draw_nav">

</nav>


<!--MAP REGION-->
<div id="map"></div>

<!-- LOAD GOOGLE -->
<script id="maps_script" async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVfkLpNr4RoZ335Hb_bY7vRHWbUptwimI&libraries=drawing&callback=initAll">
</script>

<!-- LOAD JS -->
<script src="./js/titleSwapper.js"></script>

<!-- INLINE JS -->
<script>

    //define my location
    var myLocation = {lat: 34.008928, lng: -118.491824};
    var furtherLocation = {lat:34.015, lng: -118.491824};

    //MAP VARS
    var map;
    var marker1;
    var marker1Text = 'This is where I work.';
    var marker2;
    var marker2Text = 'This is a little further away from work.';

    //store markers, assign numbers
    var markerArray = [
        {
            coordinates: {lat: 34.008928, lng: -118.491824},
            text:"my first location! ate an icecream cone."
        },
        {
            coordinates: {lat: 34.01, lng: -118.5},
            text:"my second location! shined a random person's shoes."
        },
        {
            coordinates: {lat: 34.015, lng: -118.48},
            text:"my third location! rode a bicycle into a wall."
        },
        {
            coordinates: {lat: 34.02, lng: -118.51},
            text:"my fourth location! picked up a stranger."
        },
        {
            coordinates: {lat: 34.025, lng: -118.48},
            text:"my fifth location! dropped off a stranger."
        },
        {
            coordinates: {lat: 34.03, lng: -118.51},
            text:"my sixth location! was stalked by a creeper."
        },
        {
            coordinates: {lat: 34.035, lng: -118.49},
            text:"my seventh location! took a nap."
        },
        {
            coordinates: {lat: 34.045, lng: -118.48},
            text:"my eighth location! had a child."
        },
        {
            coordinates: {lat: 34.050, lng: -118.51},
            text:"my ninth location! fed the child."
        },
        {
            coordinates: {lat: 34.051, lng: -118.50},
            text:"my tenth location! my life is all about the child."
        }
    ];




    // ====== EVENTS ======

    var addPinButton = document.getElementById('add_pin_button');
    addPinButton.addEventListener('click', function(event){
        event.preventDefault;

        addPin();
    });

    var killButton = document.getElementById('remove_bar_button');
    killButton.addEventListener('click', function(event){
        //remove nav
        document.getElementById('nav').parentNode.removeChild(document.getElementById('nav'));
    });


//    document.addEventListener('DOMContentLoaded', function(event){
//        initDrawing();
//    });






    // ====== HELPER FUNCTIONS AND CALLBACKS ========

    //parse inputs and add pin

    function addPin() {
        var lat = document.getElementById('lat_field').value;
        var lng = document.getElementById('lng_field').value;

        var lat = Number(lat);
        var lng = Number(lng);



        if (lat == '' || lng == '') {
            alert('please enter values!');
        }

        else {
            console.log('lat: ' + lat + ', long: ' + lng);

            //create markers: position, map, title

            var marker = new google.maps.Marker({position: {lat: lat, lng: lng}, map: map, title: (lat + lng).toString()});

            //clear fields
//            document.getElementById('lat_field').value = '';
//            document.getElementById('lng_field').value = '';


        }

    }

    //JSONP callback from google
    function initAll () {
        initMap();
       //initDrawing();

        //put logic here as this runs after google has been loaded.


    }


    //init map function, called by google maps javascript call
    function initMap() {
        //create new map object centered on myLocation
        map = new google.maps.Map(document.getElementById('map'), {
            center: {lat:34.035, lng: -118.491824},
            //zoom level: 1=world, 5=landmass/continent, 10=city, 15=streets, 20=building
            zoom: 14
        });

        //===== MAP STYLES =====
//        map.set('styles', [
//            {
//                featureType: 'road',
//                elementType: 'geometry',
//
//                stylers: [
//                    {color: '#000000'},
//                    {weight: '0.25'}
//                ]
//            },
//            {
//                featureType: 'road',
//                elementType: 'labels',
//
//                stylers: [
//                    {saturation: -100},
//                    {invert_lightness: true}
//                ]
//            },
//            {
//                featureType: 'landscape',
//                elementType: 'geometry',
//
//                stylers: [
//                    {hue: '#ffff00'},
//                    {gamma: 1.4},
//                    {saturation: 82},
//                    {lightness: 96}
//                ]
//            },
//            {
//                featureType: 'poi.school',
//                elementType: 'geometry',
//
//                stylers: [
//                    {hue: '#ffff700'},
//                    {lightness: -15},
//                    {saturation: 99}
//                ]
//            },
//            {
//                featureType: 'poi',
//                elementType: 'geometry',
//                stylers: [
//                    { visibility: 'off' }
//                ]
//            },
//            {
//                featureType: 'poi.school',
//                elementType: 'geometry',
//
//                stylers: [
//                    { visibility: 'on' },
//                    { hue: '#fff700' },
//                    { lightness: -15 },
//                    { saturation: 99 }
//                ]
//            }
//        ]); // == MAP STYLES - END ==


        // ===== MANUAL TEST MARKERS ======
        //create first marker at 180LA on construction
        marker1 = new google.maps.Marker({position: myLocation, map: map, title: marker1Text});

        //create second marker, then add it later
        marker2 = new google.maps.Marker({position: furtherLocation, title: marker2Text});
        //add now
        marker2.setMap(map);


        // ===== AUTO MARKERS BASED ON MARKER ARRAY ======
        // create all points on ground
        markerArray.forEach(function(element, index, array){

            console.log(array[index].text);
            console.log(array[index].coordinates.lat);

            //
            var lat = array[index].coordinates.lat;
            var lng = array[index].coordinates.lng;

            var marker = new google.maps.Marker({position: array[index].coordinates, map: map, title: array[index].text});

            var infowindow = new google.maps.InfoWindow({
                content: '<b>' +
                array[index].text +
                '</b>' +
                '<p> Some information about the location here at ' +
                array[index].coordinates.lat +
                ',' +
                array[index].coordinates.lng +
                '</p>'
            });

            marker.addListener('click', function(){
                infowindow.open(map, marker);
            });
        });


        // ===== CUSTOM INFO WINDOWS =====

        var location = {lat: -25.363, lng: 131.044};
        var contentString = '<b>My Favorite Window</b>' +
                '<p>Favorite window paragraph with awesome info. Blah blah blah blah blah more info here and there blah blah blah.</p> <img src="./img/heart-outline-sm.png">';

        var marker3 = new google.maps.Marker({
            position: location,
            map: map,
            title: 'My Favorite Title'
        });

        var infowindow = new google.maps.InfoWindow({
            content: contentString
        });

        marker3.addListener('click', function(){
            infowindow.open(map, marker3);
        });



    }

    // ====== HELPER FUNCTIONS AND CALLBACKS =====

    function initDrawing() {
        //DRAWING MANAGER
        var drawingManager = new google.maps.drawing.DrawingManager(
            {
                drawingMode: google.maps.drawing.OverlayType.MARKER,
                drawingControl: true,
                drawingControlOptions: {
                    position: google.maps.ControlPosition.TOP_CENTER,
                    drawingModes: [
                        google.maps.drawing.OverlayType.MARKER,
                        //google.maps.drawing.OverlayType.CIRCLE,
                        //google.maps.drawing.OverlayType.POLYGON,
                        google.maps.drawing.OverlayType.POLYLINE,
                        //google.maps.drawing.OverlayType.RECTANGLE
                    ]
                },
                markerOptions: {
                    icon: './img/heart-outline-sm.png'
                },

                circleOptions: {
                    fillColor: '#ffff00',
                    fillOpacity: 1,
                    strokeWeight: 1,
                    clickable: true,
                    editable: true,
                    zIndex:1
                },

                rectangleOptions: {
                    fillColor: 'rgba(255,0,0,1.0)',
                    fillOpacity: 0.25,
                    strokeWeight: 1,
                    clickable: true,
                    editable: true,
                    zIndex:1
                }
            }
        );

        drawingManager.setMap(map);
        drawingManager.setOptions(
            {
                drawingControl: true
            }
        );
    }


    //TODO: create dummy geoJSON data
    //TODO: draw line elements between markers

    //TODO: try Draw Library https://developers.google.com/maps/documentation/javascript/drawinglayer


</script>

</body>
</html>